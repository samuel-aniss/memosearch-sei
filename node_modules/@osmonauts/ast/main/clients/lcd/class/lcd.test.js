"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _lcd = require("./lcd");

var _protoParser = require("@osmonauts/proto-parser");

var _types = require("@osmonauts/types");

var _generator = _interopRequireDefault(require("@babel/generator"));

var _encoding = require("../../../encoding");

var store = new _protoParser.ProtoStore([__dirname + '/../../../../../../__fixtures__/chain1']);
store.traverseAll();

var expectCode = function expectCode(ast) {
  expect((0, _generator["default"])(ast).code).toMatchSnapshot();
};

var printCode = function printCode(ast) {
  console.log((0, _generator["default"])(ast).code);
};

it('service info template', function () {
  expect((0, _lcd.getUrlTemplateString)('/osmosis/{gamm}/v1beta1/estimate/swap_exact_amount_in')).toMatchSnapshot();
  expect((0, _lcd.getUrlTemplateString)('/osmosis/{gamm}/v1beta1/{estimate}/swap_exact_amount_in')).toMatchSnapshot();
  expect((0, _lcd.getUrlTemplateString)('/osmosis/{gamm}/{v1beta1}/{estimate}/{swap_exact_amount_in}')).toMatchSnapshot();
  expect((0, _lcd.getUrlTemplateString)('/osmosis/gamm/v1beta1/estimate/{swap_exact_amount_in}')).toMatchSnapshot();
  expect((0, _lcd.getUrlTemplateString)('/cosmos/feegrant/v1beta1/allowance/{granter}/{grantee}')).toMatchSnapshot();
});
it('template tags', function () {
  var info = {
    url: '/{cosmos}/feegrant/v1beta1/{allowance}/{granter}/{grantee}',
    pathParams: ['cosmos', 'allowance', 'granter', 'grantee']
  };
  expectCode((0, _lcd.makeTemplateTag)(info));
});
it('osmosis LCDClient', function () {
  var ref = store.findProto('osmosis/gamm/v1beta1/query.proto');
  var res = (0, _protoParser.traverse)(store, ref);
  var service = (0, _protoParser.getNestedProto)(res).Query;
  var context = new _encoding.GenericParseContext(ref, store, _types.defaultTelescopeOptions);
  var ast = (0, _lcd.createLCDClient)(context, service);
  expectCode(ast);
});
it('cosmos LCDClient', function () {
  var ref = store.findProto('cosmos/bank/v1beta1/query.proto');
  var res = (0, _protoParser.traverse)(store, ref);
  var service = (0, _protoParser.getNestedProto)(res).Query;
  var context = new _encoding.GenericParseContext(ref, store, _types.defaultTelescopeOptions);
  var ast = (0, _lcd.createLCDClient)(context, service);
  expectCode(ast);
});
it('cosmos fee LCDClient', function () {
  var ref = store.findProto('cosmos/feegrant/v1beta1/query.proto');
  var res = (0, _protoParser.traverse)(store, ref);
  var service = (0, _protoParser.getNestedProto)(res).Query;
  var context = new _encoding.GenericParseContext(ref, store, _types.defaultTelescopeOptions);
  var ast = (0, _lcd.createLCDClient)(context, service);
  expectCode(ast);
});
it('cosmos/app/v1alpha1/query.proto', function () {
  var ref = store.findProto('cosmos/app/v1alpha1/query.proto');
  var res = (0, _protoParser.traverse)(store, ref);
  var service = (0, _protoParser.getNestedProto)(res).Query;
  var context = new _encoding.GenericParseContext(ref, store, _types.defaultTelescopeOptions);
  var ast = (0, _lcd.createLCDClient)(context, service);
  expectCode(ast);
});